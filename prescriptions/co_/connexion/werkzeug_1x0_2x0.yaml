units:
  steps:
  - name: Connexion2x10x0Werkzeug1x0Step
    type: step.Group
    should_include:
      adviser_pipeline: true
    match:
    - group:
      - package_version:
          name: connexion
          version: ">=2.10.0"
          index_url: https://pypi.org/simple
      - package_version:
          name: werkzeug
          version: <1.0,>=2.0
          index_url: https://pypi.org/simple
    run:
      stack_info:
      - &stack_info
        type: WARNING
        message: Cannot install connexion >=2.10.0 when using werkzeug <1.0,>=2.0
        link: https://github.com/thoth-station/user-api/issues/1708#issuecomment-1066969750
      not_acceptable: Cannot install connexion >=2.10.0 when using werkzeug <1.0,>=2.0
  sieves:
  - name: Connexion2x10x0Werkzeug1x0Sieve
    type: sieve
    should_include:
      adviser_pipeline: true
      runtime_environments:
        # Filter connexion if Python container images are
        # shipped with the specified werkzeug.
        python_packages:
        - name: werkzeug
          version: <1.0,>=2.0
          location: ^/opt/app-root/.*
    match:
      package_version:
        name: connexion
        version: ">=2.10.0"
        index_url: https://pypi.org/simple
    run:
      stack_info:
      - <<: *stack_info
